"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const _1 = require(".");
var Task;
(function (Task) {
    async function dayAndNight(fn = _1.throwError('回调参数缺失！'), { msDayMin = 120000, // 白天的最小触发时间  120000ms => 2min
    msDayMax = 600000, // 白天的最大触发时间  600000ms => 10min
    msNightMin = 3000000, // 夜晚的最小触发时间  3000000ms => 50min
    msNightMax = 7200000, // 夜晚的最大触发时间  7200000ms => 2h
    thisArg = null, // fn 的 this 对象
    fnStop = () => false, // 停止条件函数, 如果为 true 则会停止
    fnStopCb = () => { }, // 停止后的回调函数
    loop = Infinity, // 循环次数
    args = [], // fn 的参数
    wait = false, // 是否需要在每一轮循环中等待 fn 执行完成
    debug = true // 是否开启调试信息打印
     } = {}) {
        let msAwaitTime, count = 0;
        do {
            let hour = new Date().getHours() + 1;
            let result = fn.apply(thisArg, Array.isArray(args) ? args : [args]);
            wait ? await result : result;
            // 计算下一次循环执行时间
            msAwaitTime = _1.getRandomInt.apply({}, hour > 22 || hour < 8 ? [msNightMax, msNightMin] : [msDayMax, msDayMin]); // 时间在 23 点以后 到 8 点以前为夜间
            debug && _1.log(`下一次将在${msAwaitTime / 1000 / 60}分钟后运行!`, 'warn');
        } while (await _1.wait(msAwaitTime, !(await fnStop()) && ++count < loop));
        // 执行回调
        fnStopCb();
    }
    Task.dayAndNight = dayAndNight;
    async function task2_4(fn, { min = 2000, max = 4000, thisArg = null, args = [], debug = true, wait = false, loop = Infinity, fnStop = () => false, fnStopCb = () => { } } = {}) {
        dayAndNight(fn, { msDayMin: min, msDayMax: max, msNightMin: min, msNightMax: max, thisArg, fnStop, loop, args, wait, debug, fnStopCb });
    }
    Task.task2_4 = task2_4;
})(Task = exports.Task || (exports.Task = {}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFzay5uYW1lc3BhY2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvbGliL3V0aWxzL3Rhc2submFtZXNwYWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsd0JBQWtFO0FBRWxFLElBQWlCLElBQUksQ0FrQ3BCO0FBbENELFdBQWlCLElBQUk7SUFDWixLQUFLLHNCQUNWLEtBQVUsYUFBVSxDQUFDLFNBQVMsQ0FBQyxFQUMvQixFQUNFLFFBQVEsR0FBRyxNQUFNLEVBQUUsOEJBQThCO0lBQ2pELFFBQVEsR0FBRyxNQUFNLEVBQUUsK0JBQStCO0lBQ2xELFVBQVUsR0FBRyxPQUFPLEVBQUUsZ0NBQWdDO0lBQ3RELFVBQVUsR0FBRyxPQUFPLEVBQUUsNkJBQTZCO0lBQ25ELE9BQU8sR0FBRyxJQUFJLEVBQUUsZUFBZTtJQUMvQixNQUFNLEdBQUcsR0FBUSxFQUFFLENBQUMsS0FBSyxFQUFFLHdCQUF3QjtJQUNuRCxRQUFRLEdBQUcsR0FBUSxFQUFFLEdBQUUsQ0FBQyxFQUFHLFdBQVc7SUFDdEMsSUFBSSxHQUFHLFFBQVEsRUFBRSxPQUFPO0lBQ3hCLElBQUksR0FBRyxFQUFFLEVBQUUsU0FBUztJQUNwQixJQUFJLEdBQUcsS0FBSyxFQUFFLHdCQUF3QjtJQUN0QyxLQUFLLEdBQUcsSUFBSSxDQUFDLGFBQWE7TUFDM0IsR0FBRyxFQUFFO1FBRU4sSUFBSSxXQUFXLEVBQUUsS0FBSyxHQUFHLENBQUMsQ0FBQztRQUMzQixHQUFHO1lBQ0QsSUFBSSxJQUFJLEdBQUcsSUFBSSxJQUFJLEVBQUUsQ0FBQyxRQUFRLEVBQUUsR0FBRyxDQUFDLENBQUM7WUFDckMsSUFBSSxNQUFNLEdBQUcsRUFBRSxDQUFDLEtBQUssQ0FBQyxPQUFPLEVBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7WUFDcEUsSUFBSSxDQUFDLENBQUMsQ0FBQyxNQUFNLE1BQU0sQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDO1lBRTdCLGNBQWM7WUFDZCxXQUFXLEdBQUcsZUFBWSxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUUsSUFBSSxHQUFHLEVBQUUsSUFBSSxJQUFJLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFFLFVBQVUsRUFBRSxVQUFVLENBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBRSxRQUFRLEVBQUUsUUFBUSxDQUFFLENBQUMsQ0FBQyxDQUFDLHdCQUF3QjtZQUMzSSxLQUFLLElBQUksTUFBRyxDQUFDLFFBQVEsV0FBVyxHQUFHLElBQUksR0FBRyxFQUFFLFFBQVEsRUFBRSxNQUFNLENBQUMsQ0FBQztTQUMvRCxRQUFRLE1BQU0sT0FBTSxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUMsTUFBTSxNQUFNLEVBQUUsQ0FBQyxJQUFJLEVBQUUsS0FBSyxHQUFHLElBQUksQ0FBQyxFQUFFO1FBQ3pFLE9BQU87UUFDUCxRQUFRLEVBQUUsQ0FBQztJQUNiLENBQUM7SUE1QnFCLGdCQUFXLGNBNEJoQyxDQUFBO0lBRU0sS0FBSyxrQkFBa0IsRUFBRSxFQUFFLEVBQUUsR0FBRyxHQUFHLElBQUksRUFBRSxHQUFHLEdBQUcsSUFBSSxFQUFFLE9BQU8sR0FBRyxJQUFJLEVBQUUsSUFBSSxHQUFHLEVBQUUsRUFBRSxLQUFLLEdBQUcsSUFBSSxFQUFFLElBQUksR0FBRyxLQUFLLEVBQUUsSUFBSSxHQUFHLFFBQVEsRUFBRSxNQUFNLEdBQUcsR0FBRyxFQUFFLENBQUMsS0FBSyxFQUFFLFFBQVEsR0FBRyxHQUFHLEVBQUUsR0FBRSxDQUFDLEVBQUUsR0FBRyxFQUFFO1FBQ2xMLFdBQVcsQ0FBQyxFQUFFLEVBQUUsRUFBRSxRQUFRLEVBQUUsR0FBRyxFQUFFLFFBQVEsRUFBRSxHQUFHLEVBQUUsVUFBVSxFQUFFLEdBQUcsRUFBRSxVQUFVLEVBQUUsR0FBRyxFQUFFLE9BQU8sRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLFFBQVEsRUFBRSxDQUFDLENBQUM7SUFDMUksQ0FBQztJQUZxQixZQUFPLFVBRTVCLENBQUE7QUFDSCxDQUFDLEVBbENnQixJQUFJLEdBQUosWUFBSSxLQUFKLFlBQUksUUFrQ3BCIn0=